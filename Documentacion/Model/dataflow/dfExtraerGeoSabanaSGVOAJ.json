{
	"name": "dfExtraerGeoSabanaSGVOAJ",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "aDataLake2_sa",
						"type": "LinkedServiceReference"
					},
					"name": "excelSabSGVOAJ"
				},
				{
					"dataset": {
						"referenceName": "dsPersonas",
						"type": "DatasetReference"
					},
					"name": "scPersonas"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "dsAzTPersonaInfo",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "slExcelSGVOAJ"
				},
				{
					"name": "Join1"
				},
				{
					"name": "slPersonas"
				}
			],
			"script": "source(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tformat: 'excel',\n\tfileSystem: 'sac1landing',\n\tfileName: 'Cruce BD_OAJ_CCs_vs_SGV 20201119.xlsx',\n\tsheetName: 'Cruce',\n\tfirstRowAsHeader: true) ~> excelSabSGVOAJ\nsource(output(\n\t\tidPersona as integer,\n\t\tNoIdentificacion as string,\n\t\tidTipoPersona as integer,\n\t\tPrimerNombre as string,\n\t\tSegundoNombre as string,\n\t\tPrimerApellido as string,\n\t\tSegundoApellido as string,\n\t\tidCalidadPersona as integer,\n\t\tidProceso as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> scPersonas\nexcelSabSGVOAJ select(skipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> slExcelSGVOAJ\nslPersonas, slExcelSGVOAJ join(NoIdentificacion == '0',\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nscPersonas select(mapColumn(\n\t\tidPersona,\n\t\tNoIdentificacion,\n\t\tidTipoPersona,\n\t\tPrimerNombre,\n\t\tSegundoNombre,\n\t\tPrimerApellido,\n\t\tSegundoApellido,\n\t\tidCalidadPersona\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> slPersonas\nJoin1 sink(input(\n\t\tidPersonaInfo as integer,\n\t\tidPersona as integer,\n\t\tidPais as string,\n\t\tPais as string,\n\t\tidDeptoProvEstado as string,\n\t\tDeptoProvEstado as string,\n\t\tidCiudad as string,\n\t\tCiudad as string,\n\t\tEstadoPersona as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}